<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pelly Search</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" />
    <link rel= "stylesheet" type= "text/css" href="{{ url_for('static', filename='styles/pelotonstyle.css') }}">

</head>
<body style="background-color:#e4e7eb">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <div class="searchBox">
        <br>
        <div class="textbox">
        <input type="text" name="title" id="title" class="form-control" placeholder="Search Title" >
        </div>
        <div class="textbox">
        <input type="text" name="artist" id="artist" class="form-control" placeholder="Search Song Artist" >
        <input type="checkbox" id="excludeartist" name="excludeartist" value="exclude">
        <label for="excludeartist">Exclude Artist</label>
        </div>
        <br>
        <div class="textbox">
        <select name="difficultycat" id="difficultycat" class="dropdown">
              <option value="">Choose Difficulty</option>
              <option value="Very Easy">Very Easy</option>
              <option value="Easy">Easy</option>
              <option value="Medium">Medium</option>
              <option value="Hard">Hard</option>
              <option value="Very Hard">Very Hard</option>
              <option value="PowerZone">Power Zone</option>
        </select>
        </div>
        <div class="textbox">
        <select name="typecat" id="typecat" class="dropdown">
              <option value="">Choose Category</option>
              <option value="Intervals">Intervals</option>
              <option value="Low Impact">Low Impact</option>
              <option value="Climb">Climb</option>
              <option value="Power Zone">Power Zone</option>
              <option value="Heart Rate Zone">Heart Rate Zone</option>
              <option value="Theme">Theme</option>
              <option value="Music">Music</option>
              <option value="Groove">Groove</option>
              <option value="Beginner">Beginner</option>
              <option value="Pro Cyclist">Pro Cyclist</option>
              <option value="Live DJ">Live DJ</option>
        </select>
        </div>
        <div class="textbox">
<!--        <select name="duration" id="duration" class="chosen-select">-->
        <select name="duration" id="duration" class="dropdown">
          <option value="">Choose Class Duration</option>
          <option value="5">5 Minutes</option>
          <option value="10">10 Minutes</option>
          <option value="15">15 Minutes</option>
          <option value="20">20 Minutes</option>
          <option value="30">30 Minutes</option>
          <option value="45">45 Minutes</option>
          <option value="60">60 Minutes</option>
          <option value="75">75 Minutes</option>
          <option value="90">90 Minutes</option>
      </select>
        </div>
        <br>
        <div class="textbox">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
        <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>
            <select data-placeholder="Choose Instructors..." multiple class="chosen-select" name="instructorlist" id="instructorlist" style="width: 550px">
              <option value="Matt Wilpers">Matt Wilpers</option>
              <option value="Sam Yo">Sam Yo</option>
              <option value="Tunde Oyeneyin">Tunde Oyeneyin</option>
              <option value="Hannah Frankson">Hannah Frankson</option>
              <option value="Alex Toussaint">Alex Toussaint</option>
              <option value="Ben Alldis">Ben Alldis</option>
              <option value="Cody Rigsby">Cody Rigsby</option>
              <option value="Bradley Rose">Bradley Rose</option>
              <option value="Ally Love">Ally Love</option>
              <option value="Christine D'Ercole">Christine D'Ercole</option>
              <option value="Jenn Sherman">Jenn Sherman</option>
              <option value="Denis Morton">Denis Morton</option>
              <option value="Emma Lovewell">Emma Lovewell</option>
              <option value="Erik Jäger">Eric Jäger</option>
              <option value="Hannah Corbin">Hannah Corbin</option>
              <option value="Irene Scholz">Irene Scholz</option>
              <option value="Jess King">Jess King</option>
              <option value="Kendall Toole">Kendall Toole</option>
              <option value="Leanne Hainsby">Leanne Hainsby</option>
              <option value="Olivia Amato">Olivia Amato</option>
              <option value="Robin Arzon">Robin Arzon</option>
              <option value="Christian Vande Velde">Christian Vande Velde</option>
            </select>
        </div>
    </div>
    <br>
    <div class="textbox"><button type="button" id="submitBtn" class="submitbutton">Submit</button></div>
	<p id = "datalist" class="small"></p>
    <script>
        $(".chosen-select").chosen({
            no_results_text: "Oops, nothing found!"
        });
        $(".chosen-results").css('font-size','20px');
        $(document).ready(function(e){
           $("#submitBtn").on("click",function(e){
                let titleLivebox = $("#title").val();
                let artistLivebox = $("#artist").val();
                let difficultyCatLivebox = $("#difficultycat").val();
                let durationLivebox = $("#duration").val();
                let typeCatLivebox = $("#typecat").val();
                let chosenLivebox = $("#instructorlist").chosen().val();
                let excludeArtistbox = "";
                if ($("#excludeartist").is(":checked"))
                {
                    excludeArtistbox = "exclude";
                }
                else
                {
                    excludeArtistbox = "include";
                }
                $.ajax({
                    method:"POST",
                    url:"/PelotonSearch",
                    data:{title:titleLivebox, difficultycat:difficultyCatLivebox, duration:durationLivebox, instructorchosen:chosenLivebox, typecat:typeCatLivebox, artist:artistLivebox, excludeartist:excludeArtistbox},
                    success:function(res){
                        //console.log(res);
                        let data = "";
                        $.each(res,function(index,value){
                            let diffParsed = value.Difficulty_Category;
                            if (value.Difficulty_Category == "Very Easy"){
                                diffParsed = "VeryEasy"
                            }
                            if (value.Difficulty_Category == "Very Hard"){
                                diffParsed = "VeryHard"
                            }
                            if (value.Difficulty_Category == "Power Zone")
                            {
                               data+= "<div class=myDiv><a href="+value.Workout_Link+"><img src="+value.Thumbnail+" style=float:left height=240 width=360><h2>"+value.Title+"</h2><h3>"+value.Release_Date+
                               "</h3><h3>"+value.Instructor+"</h3><h3> Difficulty: "+value.Peloton_Difficulty_Rating+"</h3><h3> User Rating: "+value.User_Rating+"% </h3>";
                            }
                            else
                            {
                               data+= "<div class=myDiv><a href="+value.Workout_Link+"><img src="+value.Thumbnail+" style=float:left height=240 width=360><h2>"+value.Title+"</h2><h3>"+value.Release_Date+
                               "</h3><h3>"+value.Instructor+ "    ·   <b class=" +diffParsed+ " >▊"+ value.Difficulty_Category +"</b></h3><h3> Difficulty: "+value.Peloton_Difficulty_Rating+
                               "</h3><h3> Output Range: "+value.Expected_Min+" kJ - "+value.Expected_Max+" kJ</h3><h3> User Rating: "+value.User_Rating+"% </h3>";
                            }
                            data+="<h4>Artists: ";
                            let songJSON = JSON.parse(value.Songs);
                            for (var i=0; i<songJSON.length; i++){
                                if( i == 0 ){
                                    data+=songJSON[i].Artist;
                                }
                                else{
                                    data+=", "+ songJSON[i].Artist;
                                }
                            }
                            data+="</h4></div></a><br>";
                        });
                        $("#datalist").html(data);
                    }
                })
            });
        })
    </script>
</body>
</html>